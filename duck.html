<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>2D 打鳥學支付｜儲值卡 vs 信用卡（穩定版）</title>
<style>
  html,body{margin:0;height:100%;background:#08131f;color:#eef2ff;font-family:system-ui,-apple-system,"Noto Sans TC";}
  #app{position:fixed;inset:0;display:flex;flex-direction:column}
  header,footer{
    padding:10px 12px;background:rgba(0,0,0,.55);
    border-bottom:1px solid rgba(255,255,255,.12);
    display:flex;gap:10px;align-items:center;justify-content:space-between
  }
  footer{border-top:1px solid rgba(255,255,255,.12);border-bottom:none}
  .pill{padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.08);
    border:1px solid rgba(255,255,255,.14);font-size:13px}
  button{background:rgba(255,255,255,.1);color:#eef2ff;border:1px solid rgba(255,255,255,.18);
    border-radius:10px;padding:8px 12px;font-size:14px}
  #stage{flex:1;position:relative;overflow:hidden}
  canvas{width:100%;height:100%;display:block}
  .overlay{
    position:absolute;inset:0;background:rgba(0,0,0,.35);
    display:flex;align-items:center;justify-content:center
  }
  .card{
    background:rgba(0,0,0,.7);border:1px solid rgba(255,255,255,.18);
    border-radius:16px;padding:16px;max-width:900px;width:92%
  }
  .q{font-size:22px;font-weight:900;line-height:1.35;margin-bottom:8px}
  .hint{color:#c9d3ff}
  .bar{height:10px;border-radius:999px;overflow:hidden;border:1px solid rgba(255,255,255,.14)}
  .fill{height:100%;width:0;background:linear-gradient(90deg,#7bd6ff,#bda7ff)}
  #fx{position:absolute;inset:0;pointer-events:none}
</style>
</head>
<body>
<div id="app">
  <header>
    <span class="pill">2D 打鳥學支付（穩定）</span>
    <span class="pill" id="stat">第 1 題</span>
  </header>

  <div id="stage">
    <canvas id="c"></canvas>
    <canvas id="fx"></canvas>

    <!-- 讀題 -->
    <div class="overlay" id="read">
      <div class="card">
        <div class="q" id="qText">—</div>
        <div class="hint" id="qHint">—</div>
        <div class="bar"><div class="fill" id="fill"></div></div>
        <div class="hint" style="margin-top:8px">5 秒後開始，點一下射擊答案</div>
      </div>
    </div>
  </div>

  <footer>
    <span class="pill" id="msg">點一下射擊</span>
    <button id="next">下一題</button>
  </footer>
</div>

<script>
/* ===== 題庫（情境 → 特性） ===== */
const BANK = [
  {
    q:"帳戶裡其實沒錢，但你還是能先買東西，下個月再付錢。這反映哪個特性？",
    hint:"看『付款時點』，不是看卡片名字。",
    correct:"先消費後付款",
    opts:[
      "先消費後付款",
      "需要先儲值",
      "即時扣款",
      "花費上限等於餘額"
    ]
  },
  {
    q:"你把卡交給家人代買，希望『最多只能花到你先放進去的金額』。",
    hint:"重點是『不能超支』。",
    correct:"花費上限等於已儲值金額",
    opts:[
      "花費上限等於已儲值金額",
      "先消費後付款",
      "有帳單日",
      "銀行先墊款"
    ]
  },
  {
    q:"每刷一次就立刻看到餘額變少，幫助你控制花費。",
    hint:"看『是否即時反映』。",
    correct:"即時扣款",
    opts:[
      "即時扣款",
      "月底帳單結算",
      "信用額度",
      "銀行墊款"
    ]
  },
  {
    q:"網購遇到爭議，能先凍結款項、再決定是否付款。",
    hint:"誰先承擔風險？",
    correct:"可申請爭議款/拒付",
    opts:[
      "可申請爭議款/拒付",
      "需要先儲值",
      "即時扣款",
      "花費上限等於餘額"
    ]
  }
];

/* ===== Canvas ===== */
const c = document.getElementById('c');
const fx = document.getElementById('fx');
const ctx = c.getContext('2d');
const fctx = fx.getContext('2d');
const stage = document.getElementById('stage');
function resize(){
  const dpr = devicePixelRatio||1;
  c.width = stage.clientWidth*dpr;
  c.height = stage.clientHeight*dpr;
  fx.width = c.width; fx.height = c.height;
  ctx.setTransform(dpr,0,0,dpr,0,0);
  fctx.setTransform(dpr,0,0,dpr,0,0);
}
window.addEventListener('resize',resize); resize();

/* ===== 狀態 ===== */
let i=0, birds=[], running=false, timer=null;
const stat=document.getElementById('stat');
const read=document.getElementById('read');
const qText=document.getElementById('qText');
const qHint=document.getElementById('qHint');
const fill=document.getElementById('fill');
const msg=document.getElementById('msg');

/* ===== 鳥 ===== */
function spawn(){
  birds=[];
  const q=BANK[i];
  const opts=[...q.opts].sort(()=>Math.random()-.5);
  opts.forEach((t,idx)=>{
    birds.push({
      t, ok:t===q.correct,
      x:Math.random()*0.8, y:0.1+Math.random()*0.7,
      vx:(Math.random()>.5?1:-1)*0.06,
      vy:(Math.random()>.5?1:-1)*0.04
    });
  });
  running=true;
}

/* ===== 畫面 ===== */
function draw(){
  ctx.clearRect(0,0,c.width,c.height);
  birds.forEach(b=>{
    b.x+=b.vx; b.y+=b.vy;
    if(b.x<0||b.x>0.8)b.vx*=-1;
    if(b.y<0.05||b.y>0.85)b.vy*=-1;

    const X=b.x*c.width, Y=b.y*c.height;
    ctx.fillStyle=b.ok?"rgba(90,220,160,.85)":"rgba(255,120,120,.85)";
    ctx.fillRect(X,Y,300,64);
    ctx.fillStyle="#000"; ctx.font="20px sans-serif";
    ctx.fillText(b.t,X+12,Y+40);
  });
  requestAnimationFrame(draw);
}
draw();

/* ===== 特效 ===== */
function hit(x,y){
  fctx.clearRect(0,0,fx.width,fx.height);
  fctx.strokeStyle="rgba(255,255,255,.9)";
  fctx.lineWidth=3;
  fctx.beginPath();
  fctx.arc(x,y,22,0,Math.PI*2); fctx.stroke();
  setTimeout(()=>fctx.clearRect(0,0,fx.width,fx.height),120);
}

/* ===== 互動 ===== */
stage.addEventListener('pointerdown',e=>{
  if(!running)return;
  const rect=stage.getBoundingClientRect();
  const x=(e.clientX-rect.left)/rect.width;
  const y=(e.clientY-rect.top)/rect.height;
  hit(x*c.width,y*c.height);
  for(const b of birds){
    if(x>b.x && x<b.x+0.3 && y>b.y && y<b.y+0.12){
      msg.textContent=b.ok?"✅ 正確":"❌ 再想想";
      running=false;
      return;
    }
  }
});

/* ===== 讀題 ===== */
function start(){
  const q=BANK[i];
  stat.textContent=`第 ${i+1} 題`;
  qText.textContent=q.q;
  qHint.textContent=q.hint;
  fill.style.width="0%";
  read.style.display="flex";
  let t=0;
  timer=setInterval(()=>{
    t++; fill.style.width=(t/5*100)+"%";
    if(t>=5){
      clearInterval(timer);
      read.style.display="none";
      spawn();
    }
  },1000);
}
document.getElementById('next').onclick=()=>{
  i=(i+1)%BANK.length;
  start();
};

start();
</script>
</body>
</html>
